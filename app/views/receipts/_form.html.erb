<table><tr><td class="formulario">
<%= form_for(@receipt) do |f| %>
  <%= render "shared/error_messages", :target => @receipt, :text => "el Recibo de Pago" %>

  <% if Rails.env.development? %>
    <p><hr></p>
    <div>
      state: <%= @receipt.state %><br>
      payment_agreement_id:  <%= @receipt.payment_agreement_id %><br>
      user_id:   <%= @receipt.user_id %><br>
    </div>
    <p><hr></p>
  <% end %>

  <% if not @receipt.id.nil? %> 
    <table class="display">
    <tr>
      <td width="127">Recibo de Pago N°:</td><td><div class="sh"><%= @receipt.id %></div></td>
      <th rowspan=20 width=16></th>
    </tr>
    </table>
    <hr>
  <% end %>
  <% @tickets.each do |a| %>
  <table class="display">
  <tr>
    <td width="127">Ticket N°:</td><td><div class="sh"><%= a.id %></div></td>
    <th rowspan=20 width=16></th>
    <td>Mandante:</td><td><div><%= a.principal_name %></div></td>
  </tr>
  <tr>
    <td>Identificador:</td><td><div class="sh"><%= a.cas_id %></div></td>
    <td>Tipo de Cobranza:</td><td> <div><%= a.collection_type_name %></div></td>
  </tr>
  <tr>
    <td>Rut:</td><td><div class="sh"><%= a.rut %> - <%= a.digit %></div></td>
    <td>Nombre:</td><td><div><%= a.name %></div></td>
  </tr>
  <tr>
    <td>Descripción del Pago:</td><td colspan="4"><div class="lg"><%= a.payment_description %>&nbsp;</div></td>
  </tr>
  <tr>
    <td>Capital:</td><td><div class="sh"><%= number_to_currency(a.capital, :precision => 0, :delimiter => ".") %></div></td>
    <td>Producto:</td><td><div><%= a.product_name %></div></td>
  </tr>
  <tr>
    <td>Interés Mora:</td><td><div class="sh"><%= number_to_currency(a.arrear_interest, :precision => 0, :delimiter => ".") %>&nbsp;</div></td>
    <td>Número:</td><td><div><%= a.number %></div></td>
  </tr>
  <tr>
    <td>Interés Plazo:</td><td><div class="sh"><%= number_to_currency(a.term_interest, :precision => 0, :delimiter => ".") %>&nbsp;</div></td>
    <td>Emisor:</td><td><div><%= a.emitter %></div></td>
  </tr>
  <tr>
    <td>Honorarios:</td><td><div class="sh"><%= number_to_currency(a.fee, :precision => 0, :delimiter => ".") %>&nbsp;</div></td>
    <td>Cuenta Corriente:</td><td><div><%= a.ctacte %></div></td>
  </tr>
  <tr>
    <td>Gastos Envío:</td><td><div class="sh"><%= a.shipping_costs %>&nbsp;</div></td>
    <td>Vencimiento:</td><td><div><%= a.expir_date %></div></td>
  </tr>
  <tr>
    <td>Gastos Judiciales:</td><td><div class="sh"><%= a.legal_costs %>&nbsp;</div></td>
    <td>Boleta nro: </td><td><div><%= a.ballot %>&nbsp;</div></td>
  </tr>
  <tr>
    <td>Total a Pagar:</td><td><div class="sh"><%= number_to_currency(a.total_pay, :precision => 0, :delimiter => ".") %>&nbsp;</div></td>
    <td>Cuota:</td><td><div class="sh"><%= a.quota_num %><% if not a.total_q.empty? %> de <%= a.total_q %><% end %>&nbsp;</div></td>
  </tr>
  <tr>
    <td>Preparado por:</td><td colspan=4><div class="lg"><%= a.prepared_by %></div></td>
  </tr>
  <tr>
    <td colspan=2>Entrega documento a deudor:</td><td><div class="sn"><% if a.doc_delivery %>Sí<% else %>No<% end %></div></td>
  </tr>
  </table>
  <hr>
  <% end %>
  <table class="datos">
  <tr>
    <td>Fecha:</td><td><%= f.date_select :date_r %></td>
    <th rowspan=20 width=16></th>
    <td>Total a Pagar: &nbsp;</td><td><%= f.text_field :total_pay, :size => "10", :value=> @total_rp, :readonly => true %></td>
  </tr>
  <tr>
    <td>Acuerdo de Pago: &nbsp;</td><td><%= f.collection_select :payment_agreement_id, PaymentAgreement.where('state = true').order('name ASC'), :id, :name %></td>
  </tr>
  <tr>
    <td>Preparado por:</td><td><%= f.text_field :user_name, :size => "30", :value => current_user.name, :readonly => true %>&nbsp;</td>
    <td>Teléfono: </td><td><%= f.text_field :telephone_user, :size => "10" , :value => current_user.telephone, :readonly => true %></td>
  </tr>
  </table>
  <div class="subtit">
    Datos de Contacto:
  </div>
  <table class="datos">
  <tr>
    <td>Nombre: </td><td><%= f.text_field :cont_name, :size => "37" %></td>
    <th rowspan=20 width=16></th>
    <td>Rut:</td><td><%= f.text_field :cont_rut, :size => "7" %>-<%= f.text_field :cont_digit, :size => "1" %></td>
  </tr>
  <tr>
    <td>Calle:</td><td><%= f.text_field :cont_calle, :size => "37" %></td>
    <td>N° </td><td><%= f.text_field :cont_num, :size => "11" %></td>
  </tr>
  <tr>
    <td>Comuna: </td><td><%= f.collection_select :comuna_id, Comuna.where('state = true').order('name ASC'), :id, :name %></td>
    <td>N° Depto.:</td><td><%= f.text_field :cont_depto, :size => "11" %></td>
  </tr>
  <tr>
    <td>Referencias:</td><td colspan=4><%= f.text_field :cont_ref, :size => "62" %></td>
  </tr>
  <tr>
    <td>Horario: </td><td><%= f.text_field :cont_hr, :size => "37" %></td>
    <td>Teléfono 1: </td><td><%= f.text_field :cont_telf1, :size => "11" %></td>
  </tr>
  <tr>
    <td>Teléfono 2: </td><td><%= f.text_field :cont_telf2, :size => "11" %></td>
    <td>Teléfono 3: </td><td><%= f.text_field :cont_telf3, :size => "11" %></td>
  </tr>
  </table>

  <div class="subtit">
    Detalle del Pago:
  </div>
    <table class="datos">
    <tr>
      <th>Forma de Pago</th>
      <th>Emisor</th>
      <th>N° Documento</th>
      <th>Monto</th>
    </tr>
    <tr>
      <td><%= f.collection_select :formapago1, PaymentForm.where('state = true').order('name ASC'), :name, :name, options ={:prompt => "- Seleccione -"} %></td>
      <td><%= f.text_field :emisor1, :size => "30" %></td>
      <td><%= f.text_field :docnum1, :size => "10" %></td>
      <td><%= f.text_field :monto1, :size => "8" %></td>
    </tr>
    <tr>
      <td><%= f.collection_select :formapago2, PaymentForm.where('state = true').order('name ASC'), :name, :name, options ={:prompt => "- Seleccione -"} %></td>
      <td><%= f.text_field :emisor2, :size => "30" %></td>
      <td><%= f.text_field :docnum2, :size => "10" %></td>
      <td><%= f.text_field :monto2, :size => "8" %></td>
    </tr>
    <tr>
      <td><%= f.collection_select :formapago3, PaymentForm.where('state = true').order('name ASC'), :name, :name, options ={:prompt => "- Seleccione -"} %></td>
      <td><%= f.text_field :emisor3, :size => "30" %></td>
      <td><%= f.text_field :docnum3, :size => "10" %></td>
      <td><%= f.text_field :monto3, :size => "8" %></td>
    </tr>
    <tr>
      <td><%= f.collection_select :formapago4, PaymentForm.where('state = true').order('name ASC'), :name, :name, options ={:prompt => "- Seleccione -"} %></td>
      <td><%= f.text_field :emisor4, :size => "30" %></td>
      <td><%= f.text_field :docnum4, :size => "10" %></td>
      <td><%= f.text_field :monto4, :size => "8" %></td>
    </tr>
    <tr>
      <td><%= f.collection_select :formapago5, PaymentForm.where('state = true').order('name ASC'), :name, :name, options ={:prompt => "- Seleccione -"} %></td>
      <td><%= f.text_field :emisor5, :size => "30" %></td>
      <td><%= f.text_field :docnum5, :size => "10" %></td>
      <td><%= f.text_field :monto5, :size => "8" %></td>
    </tr>
    <tr>
      <td><%= f.collection_select :formapago6, PaymentForm.where('state = true').order('name ASC'), :name, :name, options ={:prompt => "- Seleccione -"} %></td>
      <td><%= f.text_field :emisor6, :size => "30" %></td>
      <td><%= f.text_field :docnum6, :size => "10" %></td>
      <td><%= f.text_field :monto6, :size => "8" %></td>
    </tr>
    <tr>
      <td colspan=2></td>
      <th>Total Pagado:</th>
      <td><%= f.text_field :total_paid, :size => "8" %></td>
    </tr>
    </table>

  <div class="actions">
    <%= f.submit "Cerra Recibo de Pago" %>
  </div>

<% end %>
</td></tr></table>

